# Render Deployment Configuration
# This file enables one-click deployment of all services to Render.com

services:
  # 1. Node.js Backend API (Main Gateway)
  - type: web
    name: interview-prep-backend
    env: node
    region: singapore
    plan: free
    buildCommand: cd backend && npm install
    startCommand: cd backend && node server.js
    envVars:
      - key: NODE_ENV
        value: production
      - key: PORT
        value: 5000
      - key: FIREBASE_PROJECT_ID
        sync: false
      - key: FIREBASE_PRIVATE_KEY
        sync: false
      - key: FIREBASE_CLIENT_EMAIL
        sync: false
      - key: POSTURE_SERVICE_URL
        fromService:
          type: web
          name: posture-analysis-service
          property: host
      - key: DRESSING_SERVICE_URL
        fromService:
          type: web
          name: dressing-analysis-service
          property: host
      - key: RESUME_SERVICE_URL
        fromService:
          type: web
          name: resume-analysis-service
          property: host
      - key: MOCK_INTERVIEW_SERVICE_URL
        fromService:
          type: web
          name: mock-interview-service
          property: host

  # 2. Posture Analysis Service (Python + YOLO)
  - type: web
    name: posture-analysis-service
    env: docker
    region: singapore
    plan: free
    dockerfilePath: ./backend/posture-analysis-service/Dockerfile
    dockerContext: ./backend/posture-analysis-service
    envVars:
      - key: PORT
        value: 5001
      - key: FLASK_ENV
        value: production

  # 3. Dressing Analysis Service (Python + YOLO)
  - type: web
    name: dressing-analysis-service
    env: docker
    region: singapore
    plan: free
    dockerfilePath: ./backend/dressing-analysis-service/Dockerfile
    dockerContext: ./backend/dressing-analysis-service
    envVars:
      - key: PORT
        value: 5002
      - key: FLASK_ENV
        value: production

  # 4. Resume Analysis Service (Python + NLP)
  - type: web
    name: resume-analysis-service
    env: docker
    region: singapore
    plan: free
    dockerfilePath: ./backend/resume-analysis-service/Dockerfile
    dockerContext: ./backend/resume-analysis-service
    envVars:
      - key: PORT
        value: 5003
      - key: FLASK_ENV
        value: production
      - key: GOOGLE_APPLICATION_CREDENTIALS
        sync: false

  # 5. Mock Interview Service (Python + Gemini AI)
  - type: web
    name: mock-interview-service
    env: docker
    region: singapore
    plan: free
    dockerfilePath: ./backend/mock-interview-service/Dockerfile
    dockerContext: ./backend/mock-interview-service
    envVars:
      - key: PORT
        value: 5004
      - key: FLASK_ENV
        value: production
      - key: GEMINI_API_KEY
        sync: false
      - key: GEMINI_MODEL_NAME
        value: gemini-2.5-flash
